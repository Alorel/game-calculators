(function(B,q){function c(D,i,E){return{name:D,max:i,effect:E}}var y={saint:{Damage:{0:[{name:"Soaring Skyhawk",lvl:25,desc:"Permanently increases Skyhawk's ATK by 3000"},{name:"Brutal Strike",lvl:25,desc:"When attacking deals 250% extra skill damage on enemies below 30%"},{name:"Holylight",lvl:25,desc:"Permanently increases Hit by 100%"}],20:[{name:"Aspire",lvl:15,desc:"When attacking, damage dealt by Skyhawk will be increased by 30%"},{name:"Virtuosity",lvl:10,desc:"When using Divine Spark, it will deal 113% extra skill damage"},{name:"Earthquake",lvl:20,desc:"When using Earth Rift, it has a 40% to deal 300% extra skill damage"}],40:[{name:"Ruinous",lvl:15,desc:"When attacking, Skyhawk has a 30% chance to deal double damage"},{name:"Chain of Light",lvl:10,desc:"When equipped with a necklace that is refined to +60 or higher, the basic ATK of the M.H. weapon will be increased by 35%"},{name:"Daze Rift",lvl:20,desc:"When the target's HP is higher than 70%, using Earth Rift grants a 40% chance to extend the duration of stunning effect to 2 seconds (Takes effect when mount reaches T6)"}]}}},n=B.keys(y),r={container:"#felspire-perks",html:true},l=function(){f($(this),true)},o=function(){f($(this),false)},f=function(G,F){G=G.closest("[data-req]");var H=G.find("[data-counter]"),E=q(H.attr("data-curr")),D=G.closest(".tab-pane"),i=q(H.attr("data-max"));if(F&&E<i){H.attr("data-curr",++E);e(D)}else{if(!F&&E>0){H.attr("data-curr",--E);e(D)}}},s=function(i,D){switch(D){case"20":return i[0];case"40":return i[0]+i[20];case"80":return i[0]+i[20]+i[40];case"120":return i[0]+i[20]+i[40]+i[80];case"160":return i[0]+i[20]+i[40]+i[80]+i[120];default:return 0}},g=function(D){var G=0,F=B.keys(D),E=0;for(;E<F.length;E++){G+=D[F[E]]}return G},e=function(D,i){var E=0,F;if(typeof i==="undefined"){i=true}D.find(">div").each(function(){var H=$(this),I=H.find("[data-allocated-points]"),G,J={0:0,20:0,40:0,80:0,120:0,160:0};H.find("[data-counter]").each(function(){G+=q($(this).attr("data-curr"))});H.find("[data-req]").each(function(){J[$(this).attr("data-req")]+=q($(this).find("[data-counter]").attr("data-curr"))}).each(function(){var L=$(this),K=L.find("button"),N=L.find("[data-counter]"),M=q(N.attr("data-curr"));if(q(L.attr("data-req"))>s(J,L.attr("data-req"))){K.prop("disabled",true);if(M>0){N.attr("data-curr",0);console.log(N);i=true}}else{K.prop("disabled",false)}});G=g(J);I.text(G===0?"":G);E+=G});if(E<=10){F="[R] 350"}else{if(E<=160){F="[R] "+(340+E)}else{F="[2R] "+(240+E)}}D.find("[data-total-lvl]").text(F);if(i){e(D,false)}};for(var b=0;b<n.length;b++){var w=$("#felspire-perks-"+n[b]),p=y[n[b]],k=B.keys(p);for(var t=0;t<k.length;t++){var z=$("<div class='col-md-4'><h4><span>"+k[t]+"</span> <span data-allocated-points></span></h4></div>"),a=p[k[t]];for(var j in a){if(a.hasOwnProperty(j)){var h=a[j];for(var x=0;x<h.length;x++){var u=$("<div class='col-xs-3' data-req='"+j+"'></div>"),v=$("<strong class='show'>"+h[x].name+"</strong>"),m=$('<div data-counter data-curr="0" data-max="'+h[x].lvl+'"/>'),A=$("<button class='btn btn-sm btn-success' disabled>+</button>").click(l),d=$("<button class='btn btn-sm btn-danger' disabled>-</button>").click(o),C='<strong class="show">'+h[x].name+"</strong><hr><strong>Max level effect: </strong><span>"+h[x].desc+"</span>";if(j!==0){C+="<hr><small>Requires "+j+" points to be allocated in the "+k[t]+" tree</small>"}if(h[x].pvp){C+='<hr><span style="color:#ff0000">PvP-only perk!</span>'}v.attr("title",C).tooltip(r);z.append(u.append(v,m,A,d))}}z.append("<div style='clear:both'/>")}w.append(z)}w.append('<hr style="clear:both"/><span>Level required: </span><strong data-total-lvl>350</strong>')}$("[id^=felspire-perks-]").each(function(){e($(this))})})(Object,parseInt);